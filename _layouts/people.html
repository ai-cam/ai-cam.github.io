---
layout: default
---

<!-- People Page -->
<section class="people-page">
    <div class="shapes">
        <div class="light-img">
            {% include icons/home-slider-shape-light.svg %}
        </div>
        <div class="dark-img">
            {% include icons/home-slider-shape-dark.svg %}
        </div>
    </div>

    <div class="container">
        <div class="main-title">
            <h1>People</h1>
            <p>ai@cam brings together researchers from departments across the University.</p>
        </div>
    </div>
 </section>
<!-- People Page End -->

<!-- People Page Content -->
 <section class="people-page-content">
    <div class="shapes">
        <div class="light-img">
            {% include icons/home-news-shape-light.svg %}
        </div>
        <div class="dark-img">
            {% include icons/home-news-shape-dark.svg %}
        </div>
    </div>
    <div class="container">
        <form action="">
            <p>Select department to filter by:</p>

            <div class="select-box">
                <select name="" id="department-filter">
                    <option value="">All</option>
                    {% assign all_departments = '' | split: '' %}
                    {% for person in site.people %}
                        {% assign person_dept = person.department %}
                        {% if person.team_member and person.team_member != '' and person.team_member != '/' %}
                            {% assign team_member = site.team_members | where: "title", person.team_member | first %}
                            {% if team_member and team_member.department and team_member.department != '/' and team_member.department != 'x' %}
                                {% assign person_dept = team_member.department %}
                            {% endif %}
                        {% endif %}
                        {% if person_dept and person_dept != '' and person_dept != '/' and person_dept != 'x' %}
                            {% assign all_departments = all_departments | push: person_dept %}
                        {% endif %}
                    {% endfor %}
                    {% assign unique_departments = all_departments | uniq | sort %}
                    {% for dept in unique_departments %}
                        <option value="{{ dept }}">{{ dept }}</option>
                    {% endfor %}
                </select>

                <div class="icon"><img src="{{ '/assets/images/icons/filter-dark.svg' | relative_url }}" alt=""></div>
            </div>
        </form>

        <div class="row" id="people-container">
            {% assign sorted_people = site.people | sort: 'title' %}
            {% assign total_people = sorted_people | size %}
            {% assign initial_limit = 12 %}
            {% if total_people < 12 %}
                {% assign initial_limit = total_people %}
            {% endif %}
            {% for person in sorted_people limit: initial_limit %}
                {% assign person_photo = person.photo %}
                {% assign person_job_title = person.job_title %}
                {% assign person_department = person.department %}
                
                {% if person.team_member and person.team_member != '' and person.team_member != '/' %}
                    {% assign team_member = site.team_members | where: "title", person.team_member | first %}
                    {% if team_member %}
                        {% if team_member.photo %}{% assign person_photo = team_member.photo %}{% endif %}
                        {% if team_member.job_title %}{% assign person_job_title = team_member.job_title %}{% endif %}
                        {% if team_member.department and team_member.department != '/' and team_member.department != 'x' %}{% assign person_department = team_member.department %}{% endif %}
                    {% endif %}
                {% endif %}
                {% if person_department == '/' or person_department == 'x' %}
                    {% assign person_department = '' %}
                {% endif %}
                
                <div class="col-lg-3" data-person-id="{{ person.slug }}" data-department="{{ person_department }}">
                    <div class="item">
                        {% if person_photo %}
                        <a href="{{ person.url }}">
                            <img src="{{ person_photo | relative_url }}" alt="{{ person.title }}">
                        </a>
                        {% endif %}

                        <div class="text">
                            {% if person.title %}
                            <a href="{{ person.url }}"><h3>{{ person.title }}</h3></a>
                            {% endif %}
                            {% if person_job_title %}
                            <p>{{ person_job_title }}</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        {% if total_people > 12 %}
        <div class="load-more">
            <a href="#" id="load-more-btn" data-page="1">Load more</a>
        </div>
        {% endif %}
    </div>
 </section>
<!-- People Page Content End -->

<!-- Global Contact Banner -->
 <section class="global-contact-banner">
    <div class="container">
        <div class="item">
            <div class="row">
                <div class="col-lg-7">
                    <div class="text">
                        {% if site.data.options.people_cta.cta_title %}
                        <h2>{{ site.data.options.people_cta.cta_title }}</h2>
                        {% endif %}

                        <div class="alt-text">
                            {% if site.data.options.people_cta.cta_description %}
                            <div class="description">
                                {{ site.data.options.people_cta.cta_description | markdownify }}
                            </div>
                            {% endif %}

                            {% if site.data.options.people_cta.cta_link and site.data.options.people_cta.cta_link_text %}
                            <a href="{{ site.data.options.people_cta.cta_link }}" class="button">{{ site.data.options.people_cta.cta_link_text }} <div class="icon"><img src="{{ '/assets/images/icons/arrow-right-up-white.svg' | relative_url }}" alt=""></div></a>
                            {% endif %}
                        </div>
                    </div>
                </div>

                {% if site.data.options.people_cta.cta_image %}
                <div class="col-lg-5">
                    <img src="{{ site.data.options.people_cta.cta_image | relative_url }}" alt="" class="main-img">
                </div>
                {% endif %}
            </div>
        </div>
    </div>
 </section>
<!-- Global Contact Banner End -->

<script>
document.addEventListener('DOMContentLoaded', function() {
    const loadMoreBtn = document.getElementById('load-more-btn');
    const peopleContainer = document.getElementById('people-container');
    const departmentFilter = document.getElementById('department-filter');
    let currentPage = 1;
    const itemsPerPage = 12;
    let allPeople = [];
    let filteredPeople = [];
    let displayedCount = 0;
    let isFiltered = false;
    
    // Calculate the number of items displayed on initial load
    const initialItems = document.querySelectorAll('#people-container > div[data-person-id]');
    displayedCount = initialItems.length;

    // Fetch all people data from JSON
    function fetchAllPeople() {
        return fetch('/people.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.text();
            })
            .then(text => {
                try {
                    const data = JSON.parse(text);
                    allPeople = Array.isArray(data) ? data : [];
                    // Sort by name
                    allPeople.sort((a, b) => {
                        const nameA = (a.title || '').toLowerCase();
                        const nameB = (b.title || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
                } catch (e) {
                    console.error('Error parsing JSON:', e, 'Response text:', text);
                    allPeople = [];
                }
                return allPeople;
            })
            .catch(error => {
                console.error('Error loading people:', error);
                return [];
            });
    }

    // Render people cards into the container
    function renderPeople(people) {
        // Clear existing content in the container
        peopleContainer.innerHTML = '';
        
        people.forEach((person, index) => {
            const dept = person.department || '';
            const col = document.createElement('div');
            col.className = 'col-lg-3';
            col.setAttribute('data-person-id', person.slug);
            col.setAttribute('data-department', dept);
            col.innerHTML = `
                <div class="item">
                    ${person.photo ? `<a href="${person.url}"><img src="${person.photo}" alt="${person.title || ''}"></a>` : ''}
                    <div class="text">
                        ${person.title ? `<a href="${person.url}"><h3>${person.title}</h3></a>` : ''}
                        ${person.job_title ? `<p>${person.job_title}</p>` : ''}
                    </div>
                </div>
            `;
            peopleContainer.appendChild(col);
            
            // Fade-in animation with GSAP - with ScrollTrigger
            const newItemElement = col.querySelector('.item');
            if (newItemElement && typeof gsap !== 'undefined') {
                gsap.set(newItemElement, { opacity: 0, y: 50, scale: 0.95 });
                
                gsap.to(newItemElement, {
                    opacity: 1,
                    y: 0,
                    scale: 1,
                    duration: 0.8,
                    ease: "power3.out",
                    scrollTrigger: {
                        trigger: col,
                        start: "top 85%",
                        toggleActions: "play none none none",
                        once: true
                    }
                });
            }
        });
    }

    // Update load more button visibility
    function updateLoadMoreVisibility(totalItems, shownItems) {
        if (!loadMoreBtn) return;
        const loadMoreDiv = loadMoreBtn.closest('.load-more');
        if (loadMoreDiv) {
            loadMoreDiv.style.display = (shownItems >= totalItems) ? 'none' : '';
        }
    }

    // Load all people from JSON on page load
    fetchAllPeople().then(() => {
        // Hide load more button if there are 12 or fewer items
        updateLoadMoreVisibility(allPeople.length, displayedCount);
    });

    // When load more button is clicked
    if (loadMoreBtn) {
        loadMoreBtn.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Loading state
            const originalText = loadMoreBtn.textContent;
            loadMoreBtn.textContent = 'Loading...';
            loadMoreBtn.style.pointerEvents = 'none';
            loadMoreBtn.style.opacity = '0.7';
            
            // Mevcut scroll pozisyonunu kaydet
            const scrollBefore = window.scrollY;

            const doLoadMore = () => {
                const sourceList = isFiltered ? filteredPeople : allPeople;
                const nextPeople = sourceList.slice(displayedCount, displayedCount + itemsPerPage);
                
                if (nextPeople.length === 0) {
                    updateLoadMoreVisibility(0, 0);
                    loadMoreBtn.textContent = originalText;
                    loadMoreBtn.style.pointerEvents = '';
                    loadMoreBtn.style.opacity = '';
                    return;
                }

                let firstNewElement = null;
                
                nextPeople.forEach((person, index) => {
                    const dept = person.department || '';
                    const col = document.createElement('div');
                    col.className = 'col-lg-3';
                    col.setAttribute('data-person-id', person.slug);
                    col.setAttribute('data-department', dept);
                    col.innerHTML = `
                        <div class="item">
                            ${person.photo ? `<a href="${person.url}"><img src="${person.photo}" alt="${person.title || ''}"></a>` : ''}
                            <div class="text">
                                ${person.title ? `<a href="${person.url}"><h3>${person.title}</h3></a>` : ''}
                                ${person.job_title ? `<p>${person.job_title}</p>` : ''}
                            </div>
                        </div>
                    `;
                    
                    if (index === 0) {
                        firstNewElement = col;
                    }
                    
                    peopleContainer.appendChild(col);
                    
                    // Fade-in animation with GSAP - with ScrollTrigger
                    const newItemElement = col.querySelector('.item');
                    if (newItemElement && typeof gsap !== 'undefined') {
                        gsap.set(newItemElement, { opacity: 0, y: 50, scale: 0.95 });
                        
                        gsap.to(newItemElement, {
                            opacity: 1,
                            y: 0,
                            scale: 1,
                            duration: 0.8,
                            ease: "power3.out",
                            scrollTrigger: {
                                trigger: col,
                                start: "top 85%",
                                toggleActions: "play none none none",
                                once: true
                            }
                        });
                    }
                });

                displayedCount += nextPeople.length;
                currentPage++;

                // Preserve scroll position and scroll down slightly
                if (scrollBefore !== undefined && firstNewElement) {
                    window.scrollTo({
                        top: scrollBefore + 100,
                        behavior: 'smooth'
                    });
                }

                updateLoadMoreVisibility(sourceList.length, displayedCount);
                
                loadMoreBtn.textContent = originalText;
                loadMoreBtn.style.pointerEvents = '';
                loadMoreBtn.style.opacity = '';
            };

            if (allPeople.length === 0) {
                fetchAllPeople().then(() => {
                    setTimeout(doLoadMore, 1000);
                });
            } else {
                // 1 saniye bekle
                setTimeout(doLoadMore, 1000);
            }
        });
    }

    // When department filter changes - render all matching people from JSON
    if (departmentFilter) {
        departmentFilter.addEventListener('change', function() {
            const selectedDept = this.value;
            
            // Ensure data is loaded before filtering
            const applyFilter = () => {
                if (selectedDept === '') {
                    // "All" selected - reset to initial state with pagination
                    isFiltered = false;
                    filteredPeople = [];
                    const initialPeople = allPeople.slice(0, itemsPerPage);
                    renderPeople(initialPeople);
                    displayedCount = initialPeople.length;
                    updateLoadMoreVisibility(allPeople.length, displayedCount);
                } else {
                    // Filter by department - show all matching results (no pagination)
                    isFiltered = true;
                    filteredPeople = allPeople.filter(person => {
                        const dept = person.department || '';
                        return dept === selectedDept;
                    });
                    renderPeople(filteredPeople);
                    displayedCount = filteredPeople.length;
                    // Filtrelenmiş sonuçlarda load more gizle
                    updateLoadMoreVisibility(filteredPeople.length, displayedCount);
                }
            };

            if (allPeople.length === 0) {
                fetchAllPeople().then(applyFilter);
            } else {
                applyFilter();
            }
        });
    }
});
</script>